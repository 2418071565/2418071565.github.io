
## **定义**

信号的定义：信号是 Linux 操作系统中用于进程间通信、处理异常等情况的一种机制。它是由操作系统向一个进程或者线程发送的一种异步通知，用于通知该进程或线程某种事件已经发生，需要做出相应的处理。

在 Linux 中，信号被分类为标准信号和实时信号，每个信号都有一个唯一的编号。标准信号是最基本的信号类型，由整数编号表示，编号范围是 1 到 31。实时信号是 Linux 中的扩展信号类型，由整数编号表示，编号范围是 32 到 64。

我们可以使用 `kiil -l` 指令来查看所有信号及其编号。

## **产生信号**

### **按键**

比如上面的ctrl + c 就给进程发送了2号信号SIGINT。而ctrl + \可以给进程发送3号信号SIGQUIT。

### **系统调用**

使用 `kill` 函数，向指定进程发送指定信号。

```cpp
#include <sys/types.h>
#include <signal.h>

int kill(pid_t pid, int sig);
```

使用 `raise` 函数，向当前进程或线程发送指定信号。

```cpp
#include <signal.h>

int raise(int sig);
```

使用 `abort` 函数，向当前进程或线程发送 6 号信号。

```cpp
#include <stdlib.h>

void abort(void);
```

`abort` 函数一定会终止程序，不管有没有重新绑定 6 号信号的处理函数。


### **软件条件**

在匿名管道中，当读进程关闭时，写进程会收到系统发来的 13 号信号，终止写进程。系统发给写进程的 13 号信号就是软件条件生成的信号。

同时我们可以使用 `alarm` 函数，定时的给当前进程发送 SIGALRM 信号。

```cpp
#include <unistd.h>

unsigned int alarm(unsigned int seconds);
```

### **硬件异常**

硬件异常产生信号就是硬件发现进程的某种异常，而硬件是被操作系统管理。硬件会将异常通知给系统，系统就会向当前进程发送适当的信号。

如：野指针，除 0 等。

## **处理信号**

这里补充一些名词概念：

- 实际执行信号的处理动作叫信号**递达**

- 信号从产生到递达之间的状态叫信号**未决**

- 一个进程可以自己选择阻塞某个信号

- 被阻塞的信号，产生号就保持在未决状态，直到进程解除阻塞，才会进行递达操作。

- 注意：阻塞和忽略信号不同，阻塞信号，信号处于未决状态，并不是递达信号。忽略，是在递达信号。

### **信号处理**

处理信号有三种方式：1.使用默认方法；2.忽略此信号；3.自定义捕捉。

对于系统定义的普通函数，进程有默认的处理函数，在接收到信号以后会自动调用该处理函数。当然我们也可以自己重新定义这些信号的处理函数，通过 `signal` 函数来重定义处理函数，这被称作自定义捕捉。

```cpp
#include <signal.h>

typedef void (*sighandler_t)(int);
sighandler_t signal(int signum, sighandler_t handler);
```

将 `signum` 信号的处理函数绑定为 `handler` 函数。

要注意的是处理函数并不是在接受到信号就立即执行的，而是在一个合适的时间将接收到的信号统一执行。